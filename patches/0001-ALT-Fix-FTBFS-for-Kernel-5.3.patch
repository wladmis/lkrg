From 561ef8153d20748676829dbbeeee60fc8899bafd Mon Sep 17 00:00:00 2001
From: "Vladimir D. Seleznev" <vseleznv@altlinux.org>
Date: Thu, 6 Feb 2020 01:46:20 +0300
Subject: [PATCH] ALT: Fix FTBFS for Kernel 5.3+

---
 lkrg/src/modules/exploit_detection/p_exploit_detection.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/lkrg/src/modules/exploit_detection/p_exploit_detection.c b/lkrg/src/modules/exploit_detection/p_exploit_detection.c
index db622de..92d26f4 100644
--- a/lkrg/src/modules/exploit_detection/p_exploit_detection.c
+++ b/lkrg/src/modules/exploit_detection/p_exploit_detection.c
@@ -1086,7 +1086,7 @@ int p_ed_enforce_pcfi(struct task_struct *p_task, struct p_ed_process *p_orig, s
              "<Exploit Detection> Frame[%d] nr_entries[%d]: [0x%lx]. Full Stack:\n",
              i,p_trace.nr_entries,p_trace.entries[i]);
       printk(KERN_CRIT "--- . ---\n");
-#ifdef CONFIG_ARCH_STACKWALK
+#if defined(CONFIG_ARCH_STACKWALK) || LINUX_VERSION_CODE >= KERNEL_VERSION(5,2,0)
       stack_trace_print(p_trace.entries, p_trace.nr_entries, 0);
 #else
       print_stack_trace(&p_trace, 0);
-- 
2.24.1

